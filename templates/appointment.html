<!DOCTYPE html>
<html>
<head>
    <title>AI Chatbot</title>

    <style>
        body {
            font-family: Arial;
        }

        /* Chat Icon */
        #chatIcon {
            position: fixed;
            bottom: 25px;
            right: 25px;
            background: #4caf50;
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            font-size: 30px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            z-index: 999;
        }

        /* Chat Window */
        #chatWindow {
            position: fixed;
            bottom: 100px;
            right: 25px;
            width: 320px;
            height: 420px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.3);
            display: none;
            flex-direction: column;
            z-index: 999;
        }

        #chatHeader {
            background: #4caf50;
            padding: 12px;
            color: white;
            font-size: 18px;
            border-radius: 12px 12px 0 0;
        }

        #messages {
            padding: 10px;
            height: 300px;
            overflow-y: auto;
            background: #f7f7f7;
        }

        .user { margin: 10px 0; color: blue; }
        .bot { margin: 10px 0; color: green; }

        #inputBox {
            display: flex;
            padding: 10px;
            border-top: 1px solid #ddd;
        }

        #userMessage {
            flex: 1;
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #bbb;
        }

        #sendBtn {
            margin-left: 10px;
            background: #4caf50;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>

<body>

<!-- Floating Chat Icon -->
<div id="chatIcon">ðŸ’¬</div>

<!-- Chat Window -->
<div id="chatWindow">
    <div id="chatHeader">Chat with Us</div>

    <div id="messages"></div>

    <div id="inputBox">
        <input type="text" id="userMessage" placeholder="Type message...">
        <button id="sendBtn">Send</button>
    </div>
</div>

<script>
    // Toggle Chat Window
    $("#chatIcon").click(function () {
        $("#chatWindow").toggle();
    });

    // Send Message
    $("#sendBtn").click(function () {
        sendMessage();
    });

    $("#userMessage").keypress(function (e) {
        if (e.keyCode === 13) {
            sendMessage();
        }
    });

    function sendMessage() {
        let message = $("#userMessage").val();

        if (!message.trim()) return;

        $("#messages").append("<div class='user'><b>You:</b> " + message + "</div>");

        $.ajax({
            url: "/chatbot-response/",
            method: "POST",
            data: {
                message: message,
                csrfmiddlewaretoken: "{{ csrf_token }}"
            },
            success: function(res) {
                $("#messages").append("<div class='bot'><b>Bot:</b> " + res.response + "</div>");
                $("#userMessage").val("");
                $("#messages").scrollTop($("#messages")[0].scrollHeight);
            }
        });
    }
</script>

</body>
</html>
